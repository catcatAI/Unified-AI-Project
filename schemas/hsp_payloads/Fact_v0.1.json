{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "HSPFactPayload_v0.1",
  "description": "Schema for HSP Fact Payload version 0.1. Represents a statement about the world or an entity.",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for this fact instance. (Required)"
    },
    "statement_type": {
      "type": "string",
      "enum": ["natural_language", "semantic_triple", "json_ld"],
      "description": "Specifies the representation of the core assertion. (Required)"
    },
    "statement_nl": {
      "type": "string",
      "description": "The assertion in natural language. Required if statement_type is 'natural_language' and statement_structured is not provided."
    },
    "statement_structured": {
      "oneOf": [
        {
          "type": "object",
          "title": "SemanticTriple",
          "description": "A structured semantic triple (subject, predicate, object). Required if statement_type is 'semantic_triple'.",
          "properties": {
            "subject_uri": {"type": "string", "format": "uri-reference", "description": "URI of the subject."},
            "predicate_uri": {"type": "string", "format": "uri-reference", "description": "URI of the predicate."},
            "object_literal": {"description": "Literal value of the object (can be any JSON type)."},
            "object_uri": {"type": "string", "format": "uri-reference", "description": "URI of the object."},
            "object_datatype": {"type": "string", "format": "uri-reference", "description": "Data type URI for the object_literal (e.g., xsd:string)."}
          },
          "required": ["subject_uri", "predicate_uri"],
          "dependencies": {
            "object_literal": {"not": {"required": ["object_uri"]}},
            "object_uri": {"not": {"required": ["object_literal"]}}
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "title": "JSON-LD Object",
          "description": "A JSON-LD object representing the assertion. Required if statement_type is 'json_ld'.",
          "additionalProperties": true
        }
      ],
      "description": "Structured representation of the assertion. Its specific schema depends on statement_type."
    },
    "source_ai_id": {
      "type": "string",
      "description": "ID of the AI originating or asserting this fact (e.g., DID or URI). (Required)"
    },
    "original_source_info": {
      "type": "object",
      "description": "Information about the ultimate source if this fact was learned or relayed from an external origin.",
      "properties": {
        "type": {"type": "string", "description": "Type of the original source (e.g., 'url', 'document_id', 'user_statement')."},
        "identifier": {"type": "string", "description": "Identifier for the original source (e.g., the URL itself, a document reference)."}
      },
      "required": ["type", "identifier"],
      "additionalProperties": false
    },
    "timestamp_created": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 UTC timestamp of when this fact instance was asserted/created by the source_ai_id. (Required)"
    },
    "timestamp_observed": {
      "type": "string",
      "format": "date-time",
      "description": "Optional ISO 8601 UTC timestamp of when the described event/state was observed or occurred, if different from creation."
    },
    "confidence_score": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "The AI's confidence in the truth of this fact. (Required)"
    },
    "weight": {
      "type": "number",
      "default": 1.0,
      "description": "General-purpose weight indicating relevance, importance, or priority. Defaults to 1.0 if not provided."
    },
    "valid_from": {
      "type": "string",
      "format": "date-time",
      "description": "Optional ISO 8601 UTC timestamp from which the fact is considered valid."
    },
    "valid_until": {
      "type": "string",
      "format": "date-time",
      "description": "Optional ISO 8601 UTC timestamp until which the fact is considered valid. Absence implies validity indefinitely or until updated/retracted."
    },
    "context": {
      "type": "object",
      "description": "Key-value pairs describing the specific context in which this fact is asserted to be true. Values can be strings, numbers, or booleans.",
      "additionalProperties": {"type": ["string", "number", "boolean"]}
    },
    "tags": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Keywords or categories associated with the fact for easier discovery or grouping."
    },
    "access_policy_id": {
      "type": "string",
      "description": "Optional identifier for an access control policy governing the sharing and use of this fact."
    }
  },
  "required": [
    "id",
    "statement_type",
    "source_ai_id",
    "timestamp_created",
    "confidence_score"
  ],
  "if": {"properties": {"statement_type": {"const": "natural_language"}}},
  "then": {"required": ["statement_nl"]},
  "else": {
    "if": {"properties": {"statement_type": {"const": "semantic_triple"}}},
    "then": {"required": ["statement_structured"]},
    "else": {
      "if": {"properties": {"statement_type": {"const": "json_ld"}}},
      "then": {"required": ["statement_structured"]}
    }
  },
  "additionalProperties": false
}
