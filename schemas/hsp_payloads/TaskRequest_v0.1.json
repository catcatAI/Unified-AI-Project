{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "HSPTaskRequestPayload_v0.1",
  "description": "Schema for HSP Task Request Payload version 0.1. An AI requests another AI to perform a task using one of its advertised capabilities.",
  "type": "object",
  "properties": {
    "request_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique ID for this task request, generated by the requester. (Required)"
    },
    "requester_ai_id": {
      "type": "string",
      "description": "DID or URI of the AI making the request. (Required)"
    },
    "target_ai_id": {
      "type": "string",
      "description": "Optional specific DID or URI of the target AI. If omitted, the request might be broadcast or routed based on capability filters to any suitable AI."
    },
    "capability_id_filter": {
      "type": "string",
      "description": "ID of the specific capability being requested. Preferred for precise targeting."
    },
    "capability_name_filter": {
      "type": "string",
      "description": "Name of the capability being requested. Can be used if capability_id is unknown, but might be ambiguous."
    },
    "capability_version_filter": {
      "type": "string",
      "description": "Optional version constraint for the capability (e.g., '1.x', '>=2.0')."
    },
    "parameters": {
      "type": "object",
      "description": "Input parameters for the capability, conforming to the capability's advertised input schema. (Required)"
    },
    "requested_output_data_format": {
      "type": "string",
      "description": "Optional hint from the requester for the preferred data format of the task result payload."
    },
    "priority": {
      "type": "integer",
      "minimum": 0,
      "maximum": 10,
      "default": 5,
      "description": "Optional priority of the task (e.g., 0-low, 5-medium, 10-high). Executing AI may use this as a hint. Defaults to 5 if not provided."
    },
    "deadline_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Optional ISO 8601 UTC timestamp by which the task should ideally be completed. Executing AI may attempt to honor this."
    },
    "callback_address": {
      "type": "string",
      "description": "Optional URI/topic where the TaskResult should be sent by the executing AI. If not provided, the result might be sent to a default reply path associated with the requester_ai_id or based on the original request topic."
    },
    "context_id": {
      "type": "string",
      "description": "Optional identifier for a shared context or session, allowing the executing AI to potentially retrieve relevant information."
    }
  },
  "required": [
    "request_id",
    "requester_ai_id",
    "parameters"
  ],
  "anyOf": [
    {"required": ["capability_id_filter"]},
    {"required": ["capability_name_filter"]}
  ],
  "additionalProperties": false
}
