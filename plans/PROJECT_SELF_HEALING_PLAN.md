# 專案自持與自修復執行計畫 (Project Self-Healing Plan)

本文檔概述了使 `Unified-AI-Project` 達到自我維護、自我修復和自我同步狀態的執行計畫。所有操作將嚴格遵循此計畫，以確保系統性地達成目標。

## 核心原則

1.  **利用內建工具**：優先使用專案自有的自動化工具鏈（修復、測試、訓練系統）來解決問題。
2.  **保持整潔**：不新增冗餘的臨時腳本。任何為一次性任務建立的腳本，在完成後必須歸檔至 `archived_fix_scripts` 目錄。
3.  **迭代驗證**：每個修復步驟都必須立即通過測試系統的驗證，形成「修復 -> 驗證」的閉環。
4.  **同步一致**：最終目標是確保專案的程式碼、測試和文件三者之間保持完全同步和一致。

## 執行階段

### 第一階段：穩定「自動修復系統」

- **目標**：確保自動修復系統自身是穩定且可用的。
- **步驟**：
    1.  分析 `unified_auto_fix_system`, `auto_fix_workspace` 目錄的結構和功能。
    2.  查找並執行 `auto_fix_system_tests` 中的測試，識別系統當前的問題。
    3.  修復自動修復系統自身的 Bug，直到其所有相關測試都能穩定通過。

### 第二階段：穩定「核心測試系統」

- **目標**：確保專案的整體測試框架是可靠的，能準確反映程式碼的健康狀況。
- **步驟**：
    1.  分析 `scripts/workflow_controller.py` 和 `package.json` 中的 `test` 腳本，理解測試的執行流程。
    2.  嘗試執行 `pnpm test`，並解決在此過程中發現的任何基礎設施層面的錯誤。
    3.  修復核心測試工具（如 `intelligent_test_generator.py`），確保它們可以被後續流程調用。

### 第三階段：執行「修復與驗證」循環

- **目標**：使用穩定的工具鏈，系統性地修復整個專案的程式碼。
- **步驟**：
    1.  **乾跑自動修復系統**：在實際修復前，先執行乾跑（dry run）模式，檢查自動修復系統的輸出是否無誤。
        - 使用乾跑模式掃描整個專案，確保修復系統能正確識別問題且不會產生錯誤輸出。
        - 只有當乾跑輸出完全無問題時，才繼續實際修復步驟。
    2.  **文件複雜度分類**：根據分析結果，將文件按複雜度分類處理：
        - **簡單文件**（<50個錯誤）：立即手動修復
        - **中等文件**（50-200個錯誤）：分批修復，每批25-50個錯誤
        - **複雜文件**（>200個錯誤）：使用自動化工具（如autopep8）輔助，結合手動精修
    3.  **大文件特殊處理**：對於超過500行的大型文件：
        - 使用自動格式化工具（autopep8）進行初步修復
        - 分段驗證，確保每100-200行的修復都是正確的
        - 對於系統性縮排問題，建立標準化修復模板
    4.  啟動「自動修復系統」，對整個專案程式碼（`apps/`, `packages/`）進行全面的語法和邏輯錯誤掃描與修復。
    5.  在自動修復系統完成一批修復後，立即啟動「核心測試系統」進行回歸測試。
    6.  如果測試失敗，分析失敗原因，判斷是修復引入的新問題還是未被修復的舊問題，並重複此循環。
    7.  持續此「修復 -> 驗證」循環，直到整個專案的測試通過率達到穩定標準。

### 第四階段：同步程式碼、測試與文件

- **目標**：確保專案文件與最終的程式碼實現保持一致。
- **步驟**：
    1.  根據第三階段中的程式碼變更，識別出被修改的核心模組和功能。
    2.  使用關鍵字搜索 `docs/` 目錄，定位到描述這些模組的相關文件（`.md` 文件）。
    3.  閱讀並比對文件內容與當前程式碼的行為，更新文件中過時的描述、參數或範例。

### 第五階段：整合與歸檔

- **目標**：確保所有系統協同工作，並清理臨時文件。
- **步驟**：
    1.  確認自動修復、測試、訓練等系統之間的調用關係是暢通的。
    2.  檢查在整個過程中是否產生了任何臨時腳本或文件。
    3.  將所有臨時性、一次性的腳本歸檔到 `archived_fix_scripts` 目錄，並在腳本開頭註明其用途和完成日期。
